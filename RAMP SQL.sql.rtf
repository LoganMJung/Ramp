{\rtf1\ansi\ansicpg1252\cocoartf2709
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fmodern\fcharset0 Courier;}
{\colortbl;\red255\green255\blue255;\red204\green120\blue50;\red43\green43\blue43;\red169\green183\blue198;
\red106\green135\blue89;\red255\green198\blue109;\red104\green151\blue187;}
{\*\expandedcolortbl;;\csgenericrgb\c80000\c47059\c19608;\csgenericrgb\c16863\c16863\c16863;\csgenericrgb\c66275\c71765\c77647;
\csgenericrgb\c41569\c52941\c34902;\csgenericrgb\c100000\c77647\c42745;\csgenericrgb\c40784\c59216\c73333;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\fs20 \cf2 \cb3 WITH \cf4 candidates_base\uc0\u8232 \cf2 AS \cf4 (\uc0\u8232 	\cf2 SELECT DISTINCT \cf4 *\uc0\u8232 	\cf2 FROM \cf4 (\uc0\u8232 		\cf2 SELECT \cf4 *\uc0\u8232 		\cf2 FROM \cf4 (\uc0\u8232 			\cf2 VALUES \cf4 (\cf5 '2021-01-16 00:05:54.000000'\cf2 , \cf5 '25.05'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-07 20:53:04.000000'\cf2 , \cf5 '124.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-18 22:55:37.000000'\cf2 , \cf5 '66.58'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-21 00:36:57.000000'\cf2 , \cf5 '9.99'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-19 06:31:10.000000'\cf2 , \cf5 '22.27'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-10 01:24:04.000000'\cf2 , \cf5 '576.76'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-04 00:07:27.000000'\cf2 , \cf5 '49.91'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-25 20:36:17.000000'\cf2 , \cf5 '14.11'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-08 21:11:16.000000'\cf2 , \cf5 '112.21'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-07 00:06:21.000000'\cf2 , \cf5 '331.80'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-18 09:30:10.000000'\cf2 , \cf5 '900.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-22 20:30:14.000000'\cf2 , \cf5 '130.72'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-18 00:06:21.000000'\cf2 , \cf5 '91.53'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-01 09:29:56.000000'\cf2 , \cf5 '900.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-13 20:50:02.000000'\cf2 , \cf5 '33.04'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-05 00:06:15.000000'\cf2 , \cf5 '142.30'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-09 01:02:40.000000'\cf2 , \cf5 '15.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-12 05:49:02.000000'\cf2 , \cf5 '28.25'\uc0\u8232 				\cf4 )\cf2 , \cf4 (\cf5 '2021-01-03 00:03:22.000000'\cf2 , \cf5 '14.69'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-05 00:49:45.000000'\cf2 , \cf5 '93.25'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-12 20:38:30.000000'\cf2 , \cf5 '500.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-31 00:09:01.000000'\cf2 , \cf5 '23.10'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-11 10:56:16.000000'\cf2 , \cf5 '75.64'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-30 00:04:01.000000'\cf2 , \cf5 '6.75'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-04 11:35:53.000000'\cf2 , \cf5 '4.99'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-29 05:39:47.000000'\cf2 , \cf5 '33.73'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-08 06:37:49.000000'\cf2 , \cf5 '143.12'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-07 00:48:07.000000'\cf2 , \cf5 '20.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-24 11:01:21.000000'\cf2 , \cf5 '1058.40'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-21 04:41:26.000000'\cf2 , \cf5 '500.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-05 21:34:58.000000'\cf2 , \cf5 '100.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-06 00:48:00.000000'\cf2 , \cf5 '362.91'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-13 00:51:59.000000'\cf2 , \cf5 '19.24'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-17 00:10:53.000000'\cf2 , \cf5 '32.46'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-20 01:04:34.000000'\cf2 , \cf5 '32.76'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-30 07:55:26.000000'\cf2 , \cf5 '59.37'\uc0\u8232 				\cf4 )\cf2 , \cf4 (\cf5 '2021-01-03 11:03:52.000000'\cf2 , \cf5 '36.37'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-21 19:33:01.000000'\cf2 , \cf5 '12.99'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-30 00:58:25.000000'\cf2 , \cf5 '400.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-14 06:14:03.000000'\cf2 , \cf5 '900.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-26 00:02:21.000000'\cf2 , \cf5 '900.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-01 00:12:28.000000'\cf2 , \cf5 '5000.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-26 04:45:44.000000'\cf2 , \cf5 '900.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-23 04:31:41.000000'\cf2 , \cf5 '623.72'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-25 08:48:28.000000'\cf2 , \cf5 '33.05'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-18 01:20:23.000000'\cf2 , \cf5 '48.75'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-22 00:41:55.000000'\cf2 , \cf5 '47.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-28 00:05:20.000000'\cf2 , \cf5 '35.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-29 00:06:33.000000'\cf2 , \cf5 '1450.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-16 00:44:31.000000'\cf2 , \cf5 '82.38'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-31 13:00:35.000000'\cf2 , \cf5 '19.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-11 01:18:30.000000'\cf2 , \cf5 '2130.54'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-20 05:44:23.000000'\cf2 , \cf5 '13.02'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-27 19:50:22.000000'\cf2 , \cf5 '150.00'\uc0\u8232 				\cf4 )\cf2 , \cf4 (\cf5 '2021-01-15 00:04:12.000000'\cf2 , \cf5 '641.37'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-19 01:10:40.000000'\cf2 , \cf5 '235.44'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-27 00:37:59.000000'\cf2 , \cf5 '216.99'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-27 04:53:20.000000'\cf2 , \cf5 '54.35'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-19 00:04:03.000000'\cf2 , \cf5 '99.95'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-06 20:49:50.000000'\cf2 , \cf5 '57.08'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-17 12:39:03.000000'\cf2 , \cf5 '22.75'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-05 06:24:32.000000'\cf2 , \cf5 '500.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-31 01:56:35.000000'\cf2 , \cf5 '17.33'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-11 21:35:49.000000'\cf2 , \cf5 '10.66'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-13 06:38:51.000000'\cf2 , \cf5 '9.99'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-15 00:53:48.000000'\cf2 , \cf5 '450.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-28 00:39:16.000000'\cf2 , \cf5 '27.92'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-17 01:21:03.000000'\cf2 , \cf5 '13.61'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-02 11:07:27.000000'\cf2 , \cf5 '84.31'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-19 19:55:26.000000'\cf2 , \cf5 '15.10'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-24 01:27:27.000000'\cf2 , \cf5 '47.90'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-12 00:48:20.000000'\cf2 , \cf5 '8413.94'\uc0\u8232 				\cf4 )\cf2 , \cf4 (\cf5 '2021-01-09 00:02:48.000000'\cf2 , \cf5 '118.49'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-15 06:18:10.000000'\cf2 , \cf5 '900.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-22 00:05:13.000000'\cf2 , \cf5 '23.04'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-03 01:32:21.000000'\cf2 , \cf5 '3.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-14 00:04:24.000000'\cf2 , \cf5 '9.99'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-22 05:29:08.000000'\cf2 , \cf5 '326.24'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-10 11:05:01.000000'\cf2 , \cf5 '43.55'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-02 01:14:35.000000'\cf2 , \cf5 '513.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-20 00:03:47.000000'\cf2 , \cf5 '14.23'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-13 00:03:52.000000'\cf2 , \cf5 '429.11'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-28 04:39:11.000000'\cf2 , \cf5 '37.17'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-26 00:40:51.000000'\cf2 , \cf5 '500.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-04 21:14:08.000000'\cf2 , \cf5 '889.46'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-21 23:53:40.000000'\cf2 , \cf5 '43.99'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-24 00:06:29.000000'\cf2 , \cf5 '59.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-08 00:04:24.000000'\cf2 , \cf5 '60.46'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-06 06:49:28.000000'\cf2 , \cf5 '16.41'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-14 21:09:48.000000'\cf2 , \cf5 '100.00'\uc0\u8232 				\cf4 )\cf2 , \cf4 (\cf5 '2021-01-04 01:45:23.000000'\cf2 , \cf5 '340.80'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-20 19:46:38.000000'\cf2 , \cf5 '90.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-16 06:35:34.000000'\cf2 , \cf5 '29.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-26 19:52:38.000000'\cf2 , \cf5 '704.47'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-09 10:44:29.000000'\cf2 , \cf5 '900.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-21 00:07:15.000000'\cf2 , \cf5 '59.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-29 00:43:11.000000'\cf2 , \cf5 '17.82'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-25 00:04:42.000000'\cf2 , \cf5 '119.95'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-23 00:35:56.000000'\cf2 , \cf5 '500.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-27 00:01:48.000000'\cf2 , \cf5 '50.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-28 19:44:55.000000'\cf2 , \cf5 '8874.32'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-29 20:37:37.000000'\cf2 , \cf5 '19.35'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-06 00:04:15.000000'\cf2 , \cf5 '8.20'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-14 00:40:59.000000'\cf2 , \cf5 '2.84'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-12 00:06:22.000000'\cf2 , \cf5 '1516.39'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-07 06:31:13.000000'\cf2 , \cf5 '500.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-10 00:04:58.000000'\cf2 , \cf5 '131.44'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-23 00:02:24.000000'\cf2 , \cf5 '103.20'\uc0\u8232 				\cf4 )\cf2 , \cf4 (\cf5 '2021-01-25 01:21:44.000000'\cf2 , \cf5 '123.84'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-11 00:06:39.000000'\cf2 , \cf5 '87.10'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-01 02:01:09.000000'\cf2 , \cf5 '518.20'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-15 20:55:58.000000'\cf2 , \cf5 '47.72'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-02 00:09:43.000000'\cf2 , \cf5 '49.00'\cf4 )\cf2 , \cf4 (\cf5 '2021-01-08 00:49:22.000000'\cf2 , \cf5 '31.61'\cf4 )\uc0\u8232 			) \cf2 AS \cf4 t (tdate\cf2 , \cf4 amount)\uc0\u8232 		)\u8232 	)\u8232 \u8232 \cf2 Select \cf6 *\cf2 , \cf6 avg\cf4 (amount2) OVER(\cf2 ORDER BY \cf4 date2\uc0\u8232      \cf2 ROWS BETWEEN \cf7 2 \cf2 PRECEDING AND CURRENT ROW \cf4 )\uc0\u8232      \cf2 as \cf4 moving_average\uc0\u8232 \cf2 FROM \cf4 (\uc0\u8232 \cf2 SELECT \cf6 cast\cf4 (\cf6 substring\cf4 (\cf6 cast\cf4 (\cf6 tdate \cf2 as varchar\cf4 )\cf2 ,\cf7 1\cf2 ,\cf7 10\cf4 ) \cf2 as date\cf4 ) date2\cf2 , \cf6 avg\cf4 (\cf6 cast\cf4 (\cf6 amount \cf2 as DECIMAL\cf4 (\cf7 10\cf2 ,\cf7 5\cf4 ))) amount2\cf2 ,\cf6 count\cf4 (\cf6 amount\cf4 ) \cf2 as \cf4 count2\uc0\u8232 \cf2 FROM \cf4 candidates_base\uc0\u8232 \cf2 group by \cf6 cast\cf4 (\cf6 substring\cf4 (\cf6 cast\cf4 (\cf6 tdate \cf2 as varchar\cf4 )\cf2 ,\cf7 1\cf2 ,\cf7 10\cf4 ) \cf2 as date\cf4 )\uc0\u8232 \cf2 order by \cf6 cast\cf4 (\cf6 substring\cf4 (\cf6 cast\cf4 (\cf6 tdate \cf2 as varchar\cf4 )\cf2 ,\cf7 1\cf2 ,\cf7 10\cf4 ) \cf2 as date\cf4 ) \cf2 asc\cf4 )\uc0\u8232 \
}